---
title: 'C#每天抄一点(10)：多文档程序'
author: Flowerowl
layout: post
permalink: /449.html
duoshuo_thread_id:
  - 1266843
views:
  - 746
bot_views:
  - 2
categories:
  - 'C#'
  - 代码
---
  
今天这个小程序花了好几个小时才弄完，现在是晚上11点10分，估计今天的jQuery笔记写不了了，明天补上！

此程序相当于一个记事本，缺点是保存部分我没写好，不能正确保存，时间关系，不研究了，先放上。

不多说，上图，上代码。

<p style="text-align: center;">
  <a href="http://lazynight.me/wp-content/uploads/2011/10/11.jpg" target="_blank"><img class="size-full wp-image-450 aligncenter" title="Lazynight | 夜阑" src="http://lazynight.me/wp-content/uploads/2011/10/11.jpg" alt="" width="900" height="500" /></a>
</p>

<div class="source" style="font-family: '[object HTMLOptionElement]', Consolas, 'Lucida Console', 'Courier New'; color: #c0c0c0; background-color: #000000;">
  <span style="color: #696969;">001</span> <span style="color: #696969;">/*</span><br /> <span style="color: #696969;">002</span> <span style="color: #696969;"> * Created by SharpDevelop.</span><br /> <span style="color: #696969;">003</span> <span style="color: #696969;"> * User: Lazynight</span><br /> <span style="color: #696969;">004</span> <span style="color: #696969;"> * Date: 2011/10/12</span><br /> <span style="color: #f810b0;">005</span> <span style="color: #696969;"> * Time: 14:03</span><br /> <span style="color: #696969;">006</span> <span style="color: #696969;"> * </span><br /> <span style="color: #696969;">007</span> <span style="color: #696969;"> * To change this template use Tools | Options | Coding | Edit Standard Headers.</span><br /> <span style="color: #696969;">008</span> <span style="color: #696969;"> */</span><br /> <span style="color: #696969;">009</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System</span>;<br /> <span style="color: #f810b0;">010</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.Collections.Generic</span>;<br /> <span style="color: #696969;">011</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.Drawing</span>;<br /> <span style="color: #696969;">012</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.Windows.Forms</span>;<br /> <span style="color: #696969;">013</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.ComponentModel</span>;<br /> <span style="color: #696969;">014</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.Linq</span>;<br /> <span style="color: #f810b0;">015</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.IO</span>;<br /> <span style="color: #696969;">016</span><br /> <span style="color: #696969;">017</span> <span style="color: #ff4400; font-weight: bold;">namespace</span> <span style="color: #c0c0c0;">Lazy10_</span><span style="color: #c0c0c0;">多文档程序</span><br /> <span style="color: #696969;">018</span> <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">019</span><br /> <span style="color: #f810b0;">020</span>     <span style="color: #ff4400; font-weight: bold;">public</span> <span style="color: #ff4400; font-weight: bold;">partial</span> <span style="color: #ff4400; font-weight: bold;">class</span> <span style="color: #c0c0c0;">MainForm</span> <span style="color: #c0c0c0;">:</span> <span style="color: #c0c0c0;">Form</span><br /> <span style="color: #696969;">021</span>     <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">022</span>         <span style="color: #c0c0c0;">Form1</span> <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">=</span> <span style="color: #ff4400; font-weight: bold;">new</span> <span style="color: #c0c0c0;">Form1</span>();              <span style="color: #696969;">//新建 Lazy_Form 对象实例</span><br /> <span style="color: #696969;">023</span>         <span style="color: #ff4400; font-weight: bold;">public</span> <span style="color: #c0c0c0;">StringReader</span> <span style="color: #c0c0c0;">Lazy_SReader</span>;        <span style="color: #696969;">//字符串流对象，一行一行读取文本</span><br /> <span style="color: #696969;">024</span>         <span style="color: #ff4400; font-weight: bold;">public</span> <span style="color: #ffffff;">int</span> <span style="color: #c0c0c0;">x</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">1</span>;                          <span style="color: #696969;">//记录新建子窗口个数</span><br /> <span style="color: #f810b0;">025</span><br /> <span style="color: #696969;">026</span>         <span style="color: #ff4400; font-weight: bold;">public</span> <span style="color: #ffff00;">MainForm</span>()<br /> <span style="color: #696969;">027</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">028</span>             <span style="color: #c0c0c0;">InitializeComponent</span>();<br /> <span style="color: #696969;">029</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #f810b0;">030</span><br /> <span style="color: #696969;">031</span>         <span style="color: #ff4400; font-weight: bold;">private</span> <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #ffff00;">MainFormLoad</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">032</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">033</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">034</span><br /> <span style="color: #f810b0;">035</span>         <span style="color: #ff4400; font-weight: bold;">private</span> <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">新建</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">036</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">037</span>             <span style="color: #c0c0c0;">Form1</span> <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">=</span> <span style="color: #ff4400; font-weight: bold;">new</span> <span style="color: #c0c0c0;">Form1</span>();<br /> <span style="color: #696969;">038</span>             <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">MdiParent</span> <span style="color: #c0c0c0;">=</span> <span style="color: #ff4400; font-weight: bold;">this</span>;                     <span style="color: #696969;">//设置此窗体为子窗体</span><br /> <span style="color: #696969;">039</span>             <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span> <span style="color: #c0c0c0;">=</span> <span style="color: #d13800;">&#8220;新建文件&#8221;</span><span style="color: #c0c0c0;">+</span><span style="color: #c0c0c0;">x</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">ToString</span>();     <span style="color: #696969;">// 设置子窗体标题</span><br /> <span style="color: #f810b0;">040</span>             <span style="color: #c0c0c0;">toolStripStatusLabel1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span><span style="color: #c0c0c0;">=</span><span style="color: #d13800;">&#8220;状态：新建文档&#8221;</span>;<span style="color: #696969;">//状态栏提示信息</span><br /> <span style="color: #696969;">041</span>             <span style="color: #c0c0c0;">x</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">x</span><span style="color: #c0c0c0;">+</span><span style="color: #c0c0c0;">1</span>;<br /> <span style="color: #696969;">042</span>             <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Show</span>();<br /> <span style="color: #696969;">043</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">044</span><br /> <span style="color: #f810b0;">045</span>         <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">打开</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">046</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">047</span>             <span style="color: #c0c0c0;">openFileDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Filter</span><span style="color: #c0c0c0;">=</span><span style="color: #d13800;">&#8220;文本文件(*.txt)|*.txt&#8221;</span>;            <span style="color: #696969;">//设置打开对话框的文件类型</span><br /> <span style="color: #696969;">048</span>             <span style="color: #c0c0c0;">openFileDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Title</span><span style="color: #c0c0c0;">=</span><span style="color: #d13800;">&#8220;打开&#8221;</span>;                           <span style="color: #696969;">//设置打开对话框的标题</span><br /> <span style="color: #696969;">049</span>             <span style="color: #ff4400; font-weight: bold;">if</span>(<span style="color: #c0c0c0;">openFileDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">ShowDialog</span><span style="color: #c0c0c0;">()==</span><span style="color: #c0c0c0;">DialogResult</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">OK</span>)<br /> <span style="color: #f810b0;">050</span>             <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">051</span>                 <span style="color: #ffffff;">string</span> <span style="color: #c0c0c0;">Lazy_strname</span> <span style="color: #c0c0c0;">=</span> <span style="color: #c0c0c0;">openFileDialog1</span> <span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">FileName</span>;    <span style="color: #696969;">//提取打开文件的文件名</span><br /> <span style="color: #696969;">052</span>                 <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">openFileDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">FileName</span>;           <span style="color: #696969;">//设置子窗体名</span><br /> <span style="color: #696969;">053</span>                 <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Clear</span>();                      <span style="color: #696969;">//打开文件</span><br /> <span style="color: #696969;">054</span>                 <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">LoadFile</span>(<span style="color: #c0c0c0;">openFileDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">FileName</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">RichTextBoxStreamType</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">PlainText</span>);<br /> <span style="color: #f810b0;">055</span>                 <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">MdiParent</span><span style="color: #c0c0c0;">=</span><span style="color: #ff4400; font-weight: bold;">this</span>;                       <span style="color: #696969;">//设置窗体为子窗体</span><br /> <span style="color: #696969;">056</span>                 <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Show</span>();<br /> <span style="color: #696969;">057</span>                 <span style="color: #c0c0c0;">toolStripStatusLabel1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span><span style="color: #c0c0c0;">=</span><span style="color: #d13800;">&#8220;状态:打开文件&#8221;</span>;<br /> <span style="color: #696969;">058</span>             <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">059</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #f810b0;">060</span><br /> <span style="color: #696969;">061</span>          <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">保存</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">062</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">063</span>             <span style="color: #c0c0c0;">saveFileDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Filter</span><span style="color: #c0c0c0;">=</span><span style="color: #d13800;">&#8220;文本文件(*.txt)|*.txt&#8221;</span>;          <span style="color: #696969;">//设置保存文件类型</span><br /> <span style="color: #696969;">064</span>             <span style="color: #c0c0c0;">saveFileDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">FilterIndex</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">2</span>;<br /> <span style="color: #f810b0;">065</span>             <span style="color: #ff4400; font-weight: bold;">if</span>(<span style="color: #c0c0c0;">saveFileDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">ShowDialog</span><span style="color: #c0c0c0;">()==</span><span style="color: #c0c0c0;">DialogResult</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">OK</span>)    <span style="color: #696969;">//保存文件</span><br /> <span style="color: #696969;">066</span>             <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">067</span>                 <span style="color: #c0c0c0;">FileInfo</span> <span style="color: #c0c0c0;">finfo</span> <span style="color: #c0c0c0;">=</span> <span style="color: #ff4400; font-weight: bold;">new</span> <span style="color: #c0c0c0;">FileInfo</span>(<span style="color: #ff4400; font-weight: bold;">this</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">saveFileDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">FileName</span>);<br /> <span style="color: #696969;">068</span>                 <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SaveFile</span>(<span style="color: #c0c0c0;">finfo</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">FullName</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">RichTextBoxStreamType</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">RichText</span>);<br /> <span style="color: #696969;">069</span>             <span style="color: #c0c0c0;">}</span><br /> <span style="color: #f810b0;">070</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">071</span><br /> <span style="color: #696969;">072</span>         <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">退出</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">073</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">074</span>             <span style="color: #ff4400; font-weight: bold;">this</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Close</span>();<br /> <span style="color: #f810b0;">075</span>             <span style="color: #c0c0c0;">Application</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Exit</span>();<br /> <span style="color: #696969;">076</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">077</span><br /> <span style="color: #696969;">078</span>         <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">剪切</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">079</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #f810b0;">080</span>             <span style="color: #ffffff;">int</span> <span style="color: #c0c0c0;">Lazy_CutInt</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SelectionStart</span>;<br /> <span style="color: #696969;">081</span>             <span style="color: #c0c0c0;">Clipboard</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SetDataObject</span>(<span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SelectedText</span>);<br /> <span style="color: #696969;">082</span>             <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Substring</span>(<span style="color: #c0c0c0;"></span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">Lazy_CutInt</span><span style="color: #c0c0c0;">)+</span><span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Substring</span>(<span style="color: #c0c0c0;">Lazy_CutInt</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SelectedText</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Length</span>);<br /> <span style="color: #696969;">083</span>             <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SelectionStart</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">Lazy_CutInt</span>;<br /> <span style="color: #696969;">084</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #f810b0;">085</span><br /> <span style="color: #696969;">086</span>         <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">复制</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">087</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">088</span>             <span style="color: #c0c0c0;">Clipboard</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SetDataObject</span>(<span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SelectedText</span>);<br /> <span style="color: #696969;">089</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #f810b0;">090</span><br /> <span style="color: #696969;">091</span>         <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">粘贴</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">092</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">093</span>             <span style="color: #c0c0c0;">IDataObject</span> <span style="color: #c0c0c0;">Lazy_idata</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">Clipboard</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">GetDataObject</span>();<br /> <span style="color: #696969;">094</span>             <span style="color: #ff4400; font-weight: bold;">if</span>(<span style="color: #c0c0c0;">Lazy_idata</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">GetDataPresent</span>(<span style="color: #c0c0c0;">DataFormats</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span>))<br /> <span style="color: #f810b0;">095</span>             <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">096</span>                 <span style="color: #ffffff;">string</span> <span style="color: #c0c0c0;">PasteStr</span><span style="color: #c0c0c0;">=(</span><span style="color: #ffffff;">string</span>)<span style="color: #c0c0c0;">Lazy_idata</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">GetData</span>(<span style="color: #c0c0c0;">DataFormats</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span>);<br /> <span style="color: #696969;">097</span>                 <span style="color: #ffffff;">int</span> <span style="color: #c0c0c0;">pasted</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SelectionStart</span>;<br /> <span style="color: #696969;">098</span>                 <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Substring</span>(<span style="color: #c0c0c0;"></span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">pasted</span><span style="color: #c0c0c0;">)+</span><span style="color: #c0c0c0;">PasteStr</span><span style="color: #c0c0c0;">+</span><span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Substring</span>(<span style="color: #c0c0c0;">pasted</span>);<br /> <span style="color: #696969;">099</span>                 <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SelectionStart</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">pasted</span><span style="color: #c0c0c0;">+</span><span style="color: #c0c0c0;">PasteStr</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Length</span>;<br /> <span style="color: #f810b0;">100</span>             <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">101</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">102</span><br /> <span style="color: #696969;">103</span>         <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">全选</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">104</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #f810b0;">105</span>             <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SelectAll</span>();<br /> <span style="color: #696969;">106</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">107</span><br /> <span style="color: #696969;">108</span>         <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">字体</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">109</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #f810b0;">110</span>             <span style="color: #c0c0c0;">fontDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">ShowDialog</span>();<br /> <span style="color: #696969;">111</span>             <span style="color: #c0c0c0;">fontDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">AllowVerticalFonts</span><span style="color: #c0c0c0;">=</span><span style="color: #ff4400; font-weight: bold;">true</span>;<br /> <span style="color: #696969;">112</span>             <span style="color: #c0c0c0;">fontDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">FixedPitchOnly</span><span style="color: #c0c0c0;">=</span><span style="color: #ff4400; font-weight: bold;">true</span>;<br /> <span style="color: #696969;">113</span>             <span style="color: #c0c0c0;">fontDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">ShowApply</span><span style="color: #c0c0c0;">=</span><span style="color: #ff4400; font-weight: bold;">true</span>;<br /> <span style="color: #696969;">114</span>             <span style="color: #c0c0c0;">fontDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">ShowEffects</span><span style="color: #c0c0c0;">=</span><span style="color: #ff4400; font-weight: bold;">true</span>;<br /> <span style="color: #f810b0;">115</span>             <span style="color: #ff4400; font-weight: bold;">if</span>(<span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SelectedText</span><span style="color: #c0c0c0;">==</span><span style="color: #d13800;">&#8220;&#8221;</span>)<br /> <span style="color: #696969;">116</span>             <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">117</span>                 <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Font</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">fontDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Font</span>;<br /> <span style="color: #696969;">118</span>             <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">119</span>             <span style="color: #ff4400; font-weight: bold;">else</span><br /> <span style="color: #f810b0;">120</span>             <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">121</span>                 <span style="color: #c0c0c0;">Lazy_Form</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">richTextBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SelectionFont</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">fontDialog1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Font</span>;<br /> <span style="color: #696969;">122</span>             <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">123</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">124</span><br /> <span style="color: #f810b0;">125</span>         <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">层叠</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">126</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">127</span>             <span style="color: #ff4400; font-weight: bold;">this</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">LayoutMdi</span>(<span style="color: #c0c0c0;">MdiLayout</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Cascade</span>);<br /> <span style="color: #696969;">128</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">129</span><br /> <span style="color: #f810b0;">130</span>         <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">横向平铺</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">131</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">132</span>             <span style="color: #ff4400; font-weight: bold;">this</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">LayoutMdi</span>(<span style="color: #c0c0c0;">MdiLayout</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">TileHorizontal</span>);<br /> <span style="color: #696969;">133</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">134</span><br /> <span style="color: #f810b0;">135</span>         <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">纵向平铺</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">136</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">137</span>             <span style="color: #ff4400; font-weight: bold;">this</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">LayoutMdi</span>(<span style="color: #c0c0c0;">MdiLayout</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">TileVertical</span>);<br /> <span style="color: #696969;">138</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">139</span><br /> <span style="color: #f810b0;">140</span>         <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #c0c0c0;">图标排列</span><span style="color: #c0c0c0;">ToolStripMenuItemClick</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">141</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">142</span>             <span style="color: #ff4400; font-weight: bold;">this</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">LayoutMdi</span>(<span style="color: #c0c0c0;">MdiLayout</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">ArrangeIcons</span>);<br /> <span style="color: #696969;">143</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">144</span>     <span style="color: #c0c0c0;">}</span><br /> <span style="color: #f810b0;">145</span> <span style="color: #c0c0c0;">}</span>
</div>

<span style="color: #ff0000;"><a href="http://down.qiannao.com/space/file/flowerowl/-4e0a-4f20-5206-4eab/Lazy10_-591a-6587-6863-7a0b-5e8f.rar/.page" target="_blank"><span style="color: #ff0000;">下载源码</span></a></span>

转载请注明：[于哲的博客][1] &raquo; [C#每天抄一点(10)：多文档程序][2]

 [1]: http://localhost/wordpress
 [2]: http://localhost/wordpress/449.html