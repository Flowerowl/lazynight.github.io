---
title: THREE.JS学习笔记(3)
author: Flowerowl
layout: post
permalink: /1103.html
duoshuo_thread_id:
  - 1266939
views:
  - 1618
bot_views:
  - 2
categories:
  - Html5
  - THREE.JS
  - 代码
tags:
  - WebGL
---
  
昨天看到一个很炫的个人展示。如下视频：  
<embed src="http://player.youku.com/player.php/sid/XMjYzOTc4Mzc2/v.swf" allowFullScreen="true" quality="high" width="750" height="500" align="middle" allowScriptAccess="always" type="application/x-shockwave-flash">
</embed>于是，眼馋，也想弄一个。官方demo里带了好几个样式差不多的，不过我现在还没想出来怎么实现。

先放上一个差不多效果的吧，过几天学习学习弄个出来。

<span style="color: #33cccc;">效果图：（列侬总是带着个眼睛&#8230;）</span>

【<span style="color: #33cccc;"><a href="http://lazynight.me/z/three.js/3/demo.html" target="_blank"><span style="color: #33cccc;">在线演示</span></a></span>】(如果Chrome不能看，那就换Firefox)【<span style="color: #33cccc;"><a href="http://down.qiannao.com/space/file/flowerowl/-4e0a-4f20-5206-4eab/three.js-5b66-4e60-7b14-8bb03.rar/.page" target="_blank"><span style="color: #33cccc;">源码下载</span></a></span>】

[<img class="aligncenter size-full wp-image-1104" title="Lazynight | 夜阑" src="http://lazynight.me/wp-content/uploads/2011/12/16.jpg" alt="" width="616" height="323" />][1]

<span style="color: #33cccc;">代码：</span>

<div class="source" style="font-family: Consolas, 'Lucida Console', 'Courier New'; color: #c0c0c0; background-color: #000000;">
  <span style="color: #696969;">001</span> <span style="color: #c0c0c0;"><!</span><span style="color: #c0c0c0;">DOCTYPE</span> <span style="color: #c0c0c0;">HTML</span><span style="color: #c0c0c0;">></span><br /> <span style="color: #696969;">002</span> <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">html</span> <span style="color: #c0c0c0;">lang</span><span style="color: #c0c0c0;">=</span><span style="color: #00bbbb;">&#8220;en&#8221;</span><span style="color: #c0c0c0;">></span><br /> <span style="color: #696969;">003</span> <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">head</span><span style="color: #c0c0c0;">></span><br /> <span style="color: #696969;">004</span>     <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">meta</span> <span style="color: #c0c0c0;">charset</span><span style="color: #c0c0c0;">=</span><span style="color: #00bbbb;">&#8220;UTF-8&#8243;</span><span style="color: #c0c0c0;">></span><br /> <span style="color: #f810b0;">005</span>     <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">meta</span> <span style="color: #c0c0c0;">name</span><span style="color: #c0c0c0;">=</span><span style="color: #00bbbb;">&#8220;viewport&#8221;</span> <span style="color: #c0c0c0;">content</span><span style="color: #c0c0c0;">=</span><span style="color: #00bbbb;">&#8220;width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0&#8243;</span><span style="color: #c0c0c0;">></span><br /> <span style="color: #696969;">006</span>     <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">title</span><span style="color: #c0c0c0;">></span><span style="color: #c0c0c0;">demo</span><span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">/title></span><br /> <span style="color: #696969;">007</span>     <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">script</span> <span style="color: #c0c0c0;">src</span><span style="color: #c0c0c0;">=</span><span style="color: #00bbbb;">&#8220;../scripts/Three.js&#8221;</span><span style="color: #c0c0c0;">><</span><span style="color: #c0c0c0;">/script></span><br /> <span style="color: #696969;">008</span>     <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">script</span> <span style="color: #c0c0c0;">src</span><span style="color: #c0c0c0;">=</span><span style="color: #00bbbb;">&#8220;../scripts/RequestAnimationFrame.js&#8221;</span><span style="color: #c0c0c0;">><</span><span style="color: #c0c0c0;">/script></span><br /> <span style="color: #696969;">009</span>     <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">script</span> <span style="color: #c0c0c0;">src</span><span style="color: #c0c0c0;">=</span><span style="color: #00bbbb;">&#8220;../scripts/Stats.js&#8221;</span><span style="color: #c0c0c0;">><</span><span style="color: #c0c0c0;">/script></span><br /> <span style="color: #f810b0;">010</span>     <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">style</span><span style="color: #c0c0c0;">></span><br /> <span style="color: #696969;">011</span>         <span style="color: #c0c0c0;">body</span><span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">012</span>             <span style="color: #c0c0c0;">background</span><span style="color: #c0c0c0;">-</span><span style="color: #c0c0c0;">color</span><span style="color: #c0c0c0;">:</span><span style="color: #c0c0c0;">#</span><span style="color: #c0c0c0;">f0f0f0</span>;<br /> <span style="color: #696969;">013</span>             <span style="color: #c0c0c0;">margin</span><span style="color: #c0c0c0;">:</span><span style="color: #c0c0c0;"></span>;<br /> <span style="color: #696969;">014</span>             <span style="color: #c0c0c0;">text</span><span style="color: #c0c0c0;">-</span><span style="color: #c0c0c0;">align</span><span style="color: #c0c0c0;">:</span><span style="color: #c0c0c0;">center</span>;<br /> <span style="color: #f810b0;">015</span>             <span style="color: #c0c0c0;">overflow</span><span style="color: #c0c0c0;">:</span><span style="color: #c0c0c0;">hidden</span>;<br /> <span style="color: #696969;">016</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">017</span>     <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">/style></span><br /> <span style="color: #696969;">018</span> <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">/head></span><br /> <span style="color: #696969;">019</span> <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">body</span><span style="color: #c0c0c0;">></span><br /> <span style="color: #f810b0;">020</span> <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">div</span> <span style="color: #c0c0c0;">id</span><span style="color: #c0c0c0;">=</span><span style="color: #00bbbb;">&#8220;container&#8221;</span><span style="color: #c0c0c0;">><</span><span style="color: #c0c0c0;">/div></span><br /> <span style="color: #696969;">021</span> <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">script</span><span style="color: #c0c0c0;">></span><br /> <span style="color: #696969;">022</span> <span style="color: #00ffff; font-weight: bold;">var</span> <span style="color: #c0c0c0;">container</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">stats</span>;<br /> <span style="color: #696969;">023</span> <span style="color: #00ffff; font-weight: bold;">var</span> <span style="color: #c0c0c0;">scene</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">renderer</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">camera</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">group</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">particle</span>;<br /> <span style="color: #696969;">024</span> <span style="color: #00ffff; font-weight: bold;">var</span> <span style="color: #c0c0c0;">mouseX</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;"></span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">mouseY</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;"></span>;<br /> <span style="color: #f810b0;">025</span> <span style="color: #00ffff; font-weight: bold;">var</span> <span style="color: #c0c0c0;">windowHalfX</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">window</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">innerWidth</span><span style="color: #c0c0c0;">/</span><span style="color: #c0c0c0;">2</span>;<br /> <span style="color: #696969;">026</span> <span style="color: #00ffff; font-weight: bold;">var</span> <span style="color: #c0c0c0;">windowHalfY</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">window</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">innerHeight</span><span style="color: #c0c0c0;">/</span><span style="color: #c0c0c0;">2</span>;<br /> <span style="color: #696969;">027</span> <span style="color: #00ffff; font-weight: bold;">var</span> <span style="color: #c0c0c0;">fov</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">90</span>;<br /> <span style="color: #696969;">028</span> <span style="color: #00ffff; font-weight: bold;">var</span> <span style="color: #c0c0c0;">width</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">window</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">innerWidth</span><span style="color: #c0c0c0;">,</span><br /> <span style="color: #696969;">029</span>     <span style="color: #c0c0c0;">height</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">window</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">innerHeight</span>;<br /> <span style="color: #f810b0;">030</span> <span style="color: #00ffff; font-weight: bold;">var</span> <span style="color: #c0c0c0;">near</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">5</span><span style="color: #c0c0c0;">,</span><br /> <span style="color: #696969;">031</span>     <span style="color: #c0c0c0;">far</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">5000</span>;<br /> <span style="color: #696969;">032</span> <span style="color: #c0c0c0;">init</span>();<span style="color: #696969;">//初始化，添加场景，摄像机，贴图等.</span><br /> <span style="color: #696969;">033</span> <span style="color: #c0c0c0;">animate</span>();<br /> <span style="color: #696969;">034</span><br /> <span style="color: #f810b0;">035</span> <span style="color: #00ffff; font-weight: bold;">function</span> <span style="color: #c0c0c0;">init</span><span style="color: #c0c0c0;">(){</span><br /> <span style="color: #696969;">036</span>     <span style="color: #c0c0c0;">container</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">document</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">createElement</span>(<span style="color: #00bbbb;">&#8216;container&#8217;</span>);<br /> <span style="color: #696969;">037</span>     <span style="color: #c0c0c0;">document</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">body</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">appendChild</span>(<span style="color: #c0c0c0;">container</span>);<br /> <span style="color: #696969;">038</span><br /> <span style="color: #696969;">039</span>     <span style="color: #c0c0c0;">camera</span><span style="color: #c0c0c0;">=</span><span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #c0c0c0;">THREE</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">PerspectiveCamera</span>(<span style="color: #c0c0c0;">fov</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">width</span><span style="color: #c0c0c0;">/</span><span style="color: #c0c0c0;">height</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">near</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">far</span>);<span style="color: #696969;">//创建摄像机</span><br /> <span style="color: #f810b0;">040</span>     <span style="color: #c0c0c0;">camera</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">position</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">z</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">100</span>;<span style="color: #696969;">//距物体最近的距离</span><br /> <span style="color: #696969;">041</span>     <span style="color: #c0c0c0;">scene</span><span style="color: #c0c0c0;">=</span><span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #c0c0c0;">THREE</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Scene</span>();<span style="color: #696969;">//创建场景</span><br /> <span style="color: #696969;">042</span><br /> <span style="color: #696969;">043</span>     <span style="color: #00ffff; font-weight: bold;">var</span> <span style="color: #c0c0c0;">program</span><span style="color: #c0c0c0;">=</span><span style="color: #00ffff; font-weight: bold;">function</span>(<span style="color: #c0c0c0;">context</span><span style="color: #c0c0c0;">){</span><br /> <span style="color: #696969;">044</span><br /> <span style="color: #f810b0;">045</span>         <span style="color: #c0c0c0;">myImage</span><span style="color: #c0c0c0;">=</span><span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #c0c0c0;">Image</span>();<br /> <span style="color: #696969;">046</span>         <span style="color: #c0c0c0;">myImage</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">src</span><span style="color: #c0c0c0;">=</span><span style="color: #00bbbb;">&#8216;../images/1.jpg&#8217;</span>;<br /> <span style="color: #696969;">047</span>         <span style="color: #c0c0c0;">context</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">rotate</span>(<span style="color: #c0c0c0;">Math</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">PI</span>);<br /> <span style="color: #696969;">048</span>         <span style="color: #c0c0c0;">context</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">drawImage</span>(<span style="color: #c0c0c0;">myImage</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">50</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">50</span>);<br /> <span style="color: #696969;">049</span>     <span style="color: #c0c0c0;">}</span><br /> <span style="color: #f810b0;">050</span>     <span style="color: #c0c0c0;">group</span><span style="color: #c0c0c0;">=</span><span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #c0c0c0;">THREE</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Object3D</span>();<br /> <span style="color: #696969;">051</span>     <span style="color: #c0c0c0;">scene</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">add</span>(<span style="color: #c0c0c0;">group</span>);<br /> <span style="color: #696969;">052</span><br /> <span style="color: #696969;">053</span>     <span style="color: #00ffff; font-weight: bold;">for</span>(<span style="color: #00ffff; font-weight: bold;">var</span> <span style="color: #c0c0c0;">i</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;"></span>;<span style="color: #c0c0c0;">i</span><span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">100</span>;<span style="color: #c0c0c0;">i</span><span style="color: #c0c0c0;">++</span><span style="color: #c0c0c0;">){</span><br /> <span style="color: #696969;">054</span>         <span style="color: #c0c0c0;">particle</span><span style="color: #c0c0c0;">=</span><span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #c0c0c0;">THREE</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Particle</span>(<span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #c0c0c0;">THREE</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">ParticleCanvasMaterial</span><span style="color: #c0c0c0;">({</span><br /> <span style="color: #f810b0;">055</span>         <span style="color: #c0c0c0;">color</span><span style="color: #c0c0c0;">:</span><span style="color: #c0c0c0;">Math</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">random</span>()<span style="color: #c0c0c0;">*</span><span style="color: #c0c0c0;">0&#215;808080</span><span style="color: #c0c0c0;">+</span><span style="color: #c0c0c0;">0&#215;808080</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">program</span><span style="color: #c0c0c0;">:</span><span style="color: #c0c0c0;">program</span><span style="color: #c0c0c0;">}));</span><br /> <span style="color: #696969;">056</span>         <span style="color: #c0c0c0;">particle</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">position</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">x</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">Math</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">random</span>()<span style="color: #c0c0c0;">*</span><span style="color: #c0c0c0;">2000</span><span style="color: #c0c0c0;">-</span><span style="color: #c0c0c0;">1000</span>;<br /> <span style="color: #696969;">057</span>         <span style="color: #c0c0c0;">particle</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">position</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">y</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">Math</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">random</span>()<span style="color: #c0c0c0;">*</span><span style="color: #c0c0c0;">2000</span><span style="color: #c0c0c0;">-</span><span style="color: #c0c0c0;">1000</span>;<br /> <span style="color: #696969;">058</span>         <span style="color: #c0c0c0;">particle</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">position</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">z</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">Math</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">random</span>()<span style="color: #c0c0c0;">*</span><span style="color: #c0c0c0;">2000</span><span style="color: #c0c0c0;">-</span><span style="color: #c0c0c0;">1000</span>;<br /> <span style="color: #696969;">059</span>         <span style="color: #c0c0c0;">particle</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">scale</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">x</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">particle</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">scale</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">y</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">Math</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">random</span>()<span style="color: #c0c0c0;">*</span><span style="color: #c0c0c0;">1</span><span style="color: #c0c0c0;">+</span><span style="color: #c0c0c0;">1</span>;<br /> <span style="color: #f810b0;">060</span>         <span style="color: #c0c0c0;">group</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">add</span>(<span style="color: #c0c0c0;">particle</span>);<br /> <span style="color: #696969;">061</span><br /> <span style="color: #696969;">062</span>     <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">063</span>     <span style="color: #c0c0c0;">projector</span> <span style="color: #c0c0c0;">=</span> <span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #c0c0c0;">THREE</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Projector</span>();<br /> <span style="color: #696969;">064</span>     <span style="color: #c0c0c0;">renderer</span><span style="color: #c0c0c0;">=</span><span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #c0c0c0;">THREE</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">CanvasRenderer</span>();<span style="color: #696969;">//创建渲染器</span><br /> <span style="color: #f810b0;">065</span>     <span style="color: #c0c0c0;">renderer</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">setSize</span>(<span style="color: #c0c0c0;">width</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">height</span>);<span style="color: #696969;">//渲染面积</span><br /> <span style="color: #696969;">066</span>     <span style="color: #c0c0c0;">container</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">appendChild</span>(<span style="color: #c0c0c0;">renderer</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">domElement</span>);<br /> <span style="color: #696969;">067</span>     <span style="color: #696969;">//在container之后添加节点。</span><br /> <span style="color: #696969;">068</span><br /> <span style="color: #696969;">069</span>     <span style="color: #c0c0c0;">stats</span><span style="color: #c0c0c0;">=</span><span style="color: #00ffff; font-weight: bold;">new</span> <span style="color: #c0c0c0;">Stats</span>();<br /> <span style="color: #f810b0;">070</span>     <span style="color: #696969;">//建立一个统计器，位于左上角的那个~，用于显示帧数等信息</span><br /> <span style="color: #696969;">071</span>     <span style="color: #c0c0c0;">stats</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">domElement</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">style</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">position</span><span style="color: #c0c0c0;">=</span><span style="color: #00bbbb;">&#8216;absolute&#8217;</span>;<br /> <span style="color: #696969;">072</span>     <span style="color: #c0c0c0;">stats</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">domElement</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">style</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">top</span><span style="color: #c0c0c0;">=</span><span style="color: #00bbbb;">&#8217;0px&#8217;</span>;<span style="color: #696969;">//定义位置</span><br /> <span style="color: #696969;">073</span>     <span style="color: #c0c0c0;">container</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">appendChild</span>(<span style="color: #c0c0c0;">stats</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">domElement</span>);<span style="color: #696969;">//添加到container之后</span><br /> <span style="color: #696969;">074</span>     <span style="color: #c0c0c0;">document</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">addEventListener</span>(<span style="color: #00bbbb;">&#8216;mousemove&#8217;</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">onDocumentMouseMove</span><span style="color: #c0c0c0;">,</span><span style="color: #00ffff; font-weight: bold;">false</span>);<br /> <span style="color: #f810b0;">075</span>     <span style="color: #c0c0c0;">document</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">addEventListener</span>(<span style="color: #00bbbb;">&#8216;touchstart&#8217;</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">onDocumentTouchStart</span><span style="color: #c0c0c0;">,</span><span style="color: #00ffff; font-weight: bold;">false</span>);<br /> <span style="color: #696969;">076</span>     <span style="color: #c0c0c0;">document</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">addEventListener</span>(<span style="color: #00bbbb;">&#8216;touchmove&#8217;</span><span style="color: #c0c0c0;">,</span><span style="color: #c0c0c0;">onDocumentTouchMove</span><span style="color: #c0c0c0;">,</span><span style="color: #00ffff; font-weight: bold;">false</span>);<br /> <span style="color: #696969;">077</span>     <span style="color: #696969;">//网页元素绑定时间的方法，在FF中使用addEventListener</span><br /> <span style="color: #696969;">078</span>     <span style="color: #696969;">//而在IE中使用attachEvent来绑定事件</span><br /> <span style="color: #696969;">079</span>     <span style="color: #696969;">//最后一个属性设置该事件的响应顺序</span><br /> <span style="color: #f810b0;">080</span>     <span style="color: #696969;">//true的话将是最先触发顺序为 addEventListener->标签的mousemove事件->document.mousemove　</span><br /> <span style="color: #696969;">081</span>     <span style="color: #696969;">//false的话是最后触发</span><br /> <span style="color: #696969;">082</span>     <span style="color: #696969;">//顺序为 标签的mousemove事件->document.mousemove->addEventListener</span><br /> <span style="color: #696969;">083</span> <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">084</span><br /> <span style="color: #f810b0;">085</span> <span style="color: #00ffff; font-weight: bold;">function</span> <span style="color: #c0c0c0;">onDocumentMouseMove</span>(<span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">){</span><br /> <span style="color: #696969;">086</span>     <span style="color: #c0c0c0;">mouseX</span><span style="color: #c0c0c0;">=</span>(<span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">clientX</span><span style="color: #c0c0c0;">-</span><span style="color: #c0c0c0;">windowHalfX</span>);<br /> <span style="color: #696969;">087</span>     <span style="color: #c0c0c0;">mouseY</span><span style="color: #c0c0c0;">=</span>(<span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">clientY</span><span style="color: #c0c0c0;">-</span><span style="color: #c0c0c0;">windowHalfY</span>);<br /> <span style="color: #696969;">088</span>     <span style="color: #696969;">//clientY鼠标指针在当前网页的y坐标</span><br /> <span style="color: #696969;">089</span> <span style="color: #c0c0c0;">}</span><br /> <span style="color: #f810b0;">090</span> <span style="color: #00ffff; font-weight: bold;">function</span> <span style="color: #c0c0c0;">onDocumentTouchStart</span>(<span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">){</span><br /> <span style="color: #696969;">091</span>     <span style="color: #00ffff; font-weight: bold;">if</span>(<span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">touches</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">length</span><span style="color: #c0c0c0;">==</span><span style="color: #c0c0c0;">1</span><span style="color: #c0c0c0;">){</span><br /> <span style="color: #696969;">092</span>     <span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">preventDefault</span>();<br /> <span style="color: #696969;">093</span>     <span style="color: #c0c0c0;">mouseX</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">touches</span><span style="color: #c0c0c0;">[</span><span style="color: #c0c0c0;"></span><span style="color: #c0c0c0;">].</span><span style="color: #c0c0c0;">pageX</span><span style="color: #c0c0c0;">-</span><span style="color: #c0c0c0;">windowHalfX</span>;<br /> <span style="color: #696969;">094</span>     <span style="color: #c0c0c0;">mouseY</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">touches</span><span style="color: #c0c0c0;">[</span><span style="color: #c0c0c0;"></span><span style="color: #c0c0c0;">].</span><span style="color: #c0c0c0;">pageY</span><span style="color: #c0c0c0;">-</span><span style="color: #c0c0c0;">windowHalfY</span>;<br /> <span style="color: #f810b0;">095</span><br /> <span style="color: #696969;">096</span>     <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">097</span> <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">098</span> <span style="color: #00ffff; font-weight: bold;">function</span> <span style="color: #c0c0c0;">onDocumentTouchMove</span>(<span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">){</span><br /> <span style="color: #696969;">099</span>     <span style="color: #00ffff; font-weight: bold;">if</span>(<span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">touches</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">length</span><span style="color: #c0c0c0;">==</span><span style="color: #c0c0c0;">1</span><span style="color: #c0c0c0;">){</span><br /> <span style="color: #f810b0;">100</span>         <span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">preventDefault</span>();<br /> <span style="color: #696969;">101</span>         <span style="color: #c0c0c0;">mouseX</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">touches</span><span style="color: #c0c0c0;">[</span><span style="color: #c0c0c0;"></span><span style="color: #c0c0c0;">].</span><span style="color: #c0c0c0;">pageX</span><span style="color: #c0c0c0;">-</span><span style="color: #c0c0c0;">windowHalfX</span>;<br /> <span style="color: #696969;">102</span>         <span style="color: #c0c0c0;">mouseY</span><span style="color: #c0c0c0;">=</span><span style="color: #c0c0c0;">event</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">touches</span><span style="color: #c0c0c0;">[</span><span style="color: #c0c0c0;"></span><span style="color: #c0c0c0;">].</span><span style="color: #c0c0c0;">pageY</span><span style="color: #c0c0c0;">-</span><span style="color: #c0c0c0;">windowHalfY</span>;<br /> <span style="color: #696969;">103</span>     <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">104</span> <span style="color: #c0c0c0;">}</span><br /> <span style="color: #f810b0;">105</span> <span style="color: #00ffff; font-weight: bold;">function</span> <span style="color: #c0c0c0;">animate</span><span style="color: #c0c0c0;">(){</span><br /> <span style="color: #696969;">106</span>     <span style="color: #c0c0c0;">requestAnimationFrame</span>(<span style="color: #c0c0c0;">animate</span>);<br /> <span style="color: #696969;">107</span>     <span style="color: #696969;">//通过这个新动画函数才得以显示</span><br /> <span style="color: #696969;">108</span>     <span style="color: #696969;">//调用requestAnimationFrame函数，传递一个callback参数，则在下一个动画帧时，会调用callback。 </span><br /> <span style="color: #696969;">109</span>     <span style="color: #c0c0c0;">render</span>();<br /> <span style="color: #f810b0;">110</span>     <span style="color: #c0c0c0;">stats</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">update</span>();<span style="color: #696969;">//更新当前统计</span><br /> <span style="color: #696969;">111</span> <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">112</span><br /> <span style="color: #696969;">113</span> <span style="color: #00ffff; font-weight: bold;">function</span> <span style="color: #c0c0c0;">render</span><span style="color: #c0c0c0;">(){</span><br /> <span style="color: #696969;">114</span>     <span style="color: #c0c0c0;">camera</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">position</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">x</span> <span style="color: #c0c0c0;">+=</span> ( <span style="color: #c0c0c0;">mouseX</span> <span style="color: #c0c0c0;">-</span> <span style="color: #c0c0c0;">camera</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">position</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">x</span> ) <span style="color: #c0c0c0;">*</span> <span style="color: #c0c0c0;">0.01</span>;<br /> <span style="color: #f810b0;">115</span>     <span style="color: #696969;">// Camera也继承自THREE.Object3D。</span><br /> <span style="color: #696969;">116</span>     <span style="color: #c0c0c0;">camera</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">position</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">y</span> <span style="color: #c0c0c0;">+=</span> ( <span style="color: #c0c0c0;">mouseY</span> <span style="color: #c0c0c0;">-</span> <span style="color: #c0c0c0;">camera</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">position</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">y</span> ) <span style="color: #c0c0c0;">*</span> <span style="color: #c0c0c0;">0.01</span>;<br /> <span style="color: #696969;">117</span>     <span style="color: #c0c0c0;">camera</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">lookAt</span>( <span style="color: #c0c0c0;">scene</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">position</span> );<br /> <span style="color: #696969;">118</span>     <span style="color: #696969;">//摄像机对准场景，否则只能左右平移观察&#8230;</span><br /> <span style="color: #696969;">119</span>     <span style="color: #c0c0c0;">group</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">rotation</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">x</span><span style="color: #c0c0c0;">+=</span><span style="color: #c0c0c0;">0.001</span>;<span style="color: #696969;">//颗粒移动速度</span><br /> <span style="color: #f810b0;">120</span>     <span style="color: #c0c0c0;">group</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">rotation</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">y</span><span style="color: #c0c0c0;">+=</span><span style="color: #c0c0c0;">0.001</span>;<br /> <span style="color: #696969;">121</span>     <span style="color: #c0c0c0;">renderer</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">render</span>( <span style="color: #c0c0c0;">scene</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">camera</span> );<br /> <span style="color: #696969;">122</span> <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">123</span> <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">/script></span><br /> <span style="color: #696969;">124</span> <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">/body></span><br /> <span style="color: #f810b0;">125</span> <span style="color: #c0c0c0;"><</span><span style="color: #c0c0c0;">/html></span>
</div>

&nbsp;

转载请注明：[于哲的博客][2] &raquo; [THREE.JS学习笔记(3)][3]

 [1]: http://lazynight.me/wp-content/uploads/2011/12/16.jpg
 [2]: http://localhost/wordpress
 [3]: http://localhost/wordpress/1103.html