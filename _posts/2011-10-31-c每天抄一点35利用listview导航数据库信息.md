---
title: 'C#每天抄一点(35):利用ListView导航数据库信息'
author: Flowerowl
layout: post
permalink: /800.html
duoshuo_thread_id:
  - 1266898
views:
  - 679
bot_views:
  - 2
categories:
  - 'C#'
  - 代码
---
<img class="aligncenter size-full wp-image-801" title="Lazynight | 夜阑" src="http://lazynight.me/wp-content/uploads/2011/10/20111031190354.jpg" alt="" width="549" height="358" />

<div class="source" style="font-family: '[object HTMLOptionElement]', Consolas, 'Lucida Console', 'Courier New'; color: #c0c0c0; background-color: #000000;">
  <span style="color: #696969;">01</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System</span>;<br /> <span style="color: #696969;">02</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.Collections.Generic</span>;<br /> <span style="color: #696969;">03</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.ComponentModel</span>;<br /> <span style="color: #696969;">04</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.Data</span>;<br /> <span style="color: #f810b0;">05</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.Drawing</span>;<br /> <span style="color: #696969;">06</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.Linq</span>;<br /> <span style="color: #696969;">07</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.Text</span>;<br /> <span style="color: #696969;">08</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.Windows.Forms</span>;<br /> <span style="color: #696969;">09</span><br /> <span style="color: #f810b0;">10</span> <span style="color: #ff4400; font-weight: bold;">using</span> <span style="color: #c0c0c0;">System.Data.OleDb</span>;<br /> <span style="color: #696969;">11</span><br /> <span style="color: #696969;">12</span> <span style="color: #ff4400; font-weight: bold;">namespace</span> <span style="color: #c0c0c0;">Case05_4</span><br /> <span style="color: #696969;">13</span> <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">14</span>     <span style="color: #ff4400; font-weight: bold;">public</span> <span style="color: #ff4400; font-weight: bold;">partial</span> <span style="color: #ff4400; font-weight: bold;">class</span> <span style="color: #c0c0c0;">Form1</span> <span style="color: #c0c0c0;">:</span> <span style="color: #c0c0c0;">Form</span><br /> <span style="color: #f810b0;">15</span>     <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">16</span>         <span style="color: #ff4400; font-weight: bold;">public</span> <span style="color: #ffff00;">Form1</span>()<br /> <span style="color: #696969;">17</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">18</span>             <span style="color: #c0c0c0;">InitializeComponent</span>();<br /> <span style="color: #696969;">19</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #f810b0;">20</span><br /> <span style="color: #696969;">21</span>         <span style="color: #c0c0c0;">OleDbConnection</span> <span style="color: #c0c0c0;">Lazy_con</span>;<br /> <span style="color: #696969;">22</span>         <span style="color: #ffffff;">string</span> <span style="color: #c0c0c0;">Lazy_music</span>;<br /> <span style="color: #696969;">23</span><br /> <span style="color: #696969;">24</span>         <span style="color: #ff4400; font-weight: bold;">public</span> <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #ffff00;">getScoure</span>(<span style="color: #ffffff;">string</span> <span style="color: #c0c0c0;">str_name</span>)<br /> <span style="color: #f810b0;">25</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">26</span>             <span style="color: #ffffff;">string</span> <span style="color: #c0c0c0;">Lazy_sql</span> <span style="color: #c0c0c0;">=</span> <span style="color: #d13800;">&#8220;select * from LazyData where 歌曲 = &#8216;&#8221;</span> <span style="color: #c0c0c0;">+</span> <span style="color: #c0c0c0;">Lazy_music</span> <span style="color: #c0c0c0;">+</span> <span style="color: #d13800;">&#8220;&#8216;&#8221;</span>;<br /> <span style="color: #696969;">27</span>             <span style="color: #696969;">//Sql查询语句</span><br /> <span style="color: #696969;">28</span>             <span style="color: #c0c0c0;">OleDbCommand</span> <span style="color: #c0c0c0;">mycom</span> <span style="color: #c0c0c0;">=</span> <span style="color: #ff4400; font-weight: bold;">new</span> <span style="color: #c0c0c0;">OleDbCommand</span>(<span style="color: #c0c0c0;">Lazy_sql</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">Lazy_con</span>);<br /> <span style="color: #696969;">29</span>             <span style="color: #696969;">//定义OleDbCommand对象实例并连接数据库</span><br /> <span style="color: #f810b0;">30</span>             <span style="color: #c0c0c0;">OleDbDataReader</span> <span style="color: #c0c0c0;">Lazy_read</span> <span style="color: #c0c0c0;">=</span> <span style="color: #c0c0c0;">mycom</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">ExecuteReader</span>();<br /> <span style="color: #696969;">31</span>             <span style="color: #696969;">//定义OleDbDataReader对象实例</span><br /> <span style="color: #696969;">32</span>             <span style="color: #ff4400; font-weight: bold;">while</span> (<span style="color: #c0c0c0;">Lazy_read</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Read</span>())<br /> <span style="color: #696969;">33</span>             <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">34</span>                 <span style="color: #ff4400; font-weight: bold;">this</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">textBox1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span> <span style="color: #c0c0c0;">=</span> <span style="color: #c0c0c0;">Lazy_read</span><span style="color: #c0c0c0;">[</span><span style="color: #c0c0c0;">1</span><span style="color: #c0c0c0;">].</span><span style="color: #c0c0c0;">ToString</span>();<br /> <span style="color: #f810b0;">35</span>                 <span style="color: #696969;">//把数据库表中的记录显示在相应的文本框中</span><br /> <span style="color: #696969;">36</span>                 <span style="color: #ff4400; font-weight: bold;">this</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">textBox2</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span> <span style="color: #c0c0c0;">=</span> <span style="color: #c0c0c0;">Lazy_read</span><span style="color: #c0c0c0;">[</span><span style="color: #c0c0c0;">2</span><span style="color: #c0c0c0;">].</span><span style="color: #c0c0c0;">ToString</span>();<br /> <span style="color: #696969;">37</span>                 <span style="color: #ff4400; font-weight: bold;">this</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">textBox3</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span> <span style="color: #c0c0c0;">=</span> <span style="color: #c0c0c0;">Lazy_read</span><span style="color: #c0c0c0;">[</span><span style="color: #c0c0c0;">3</span><span style="color: #c0c0c0;">].</span><span style="color: #c0c0c0;">ToString</span>();<br /> <span style="color: #696969;">38</span>                 <span style="color: #ff4400; font-weight: bold;">this</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">textBox4</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span> <span style="color: #c0c0c0;">=</span> <span style="color: #c0c0c0;">Lazy_read</span><span style="color: #c0c0c0;">[</span><span style="color: #c0c0c0;">4</span><span style="color: #c0c0c0;">].</span><span style="color: #c0c0c0;">ToString</span>();<br /> <span style="color: #696969;">39</span>                 <span style="color: #ff4400; font-weight: bold;">this</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">textBox5</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Text</span> <span style="color: #c0c0c0;">=</span> <span style="color: #c0c0c0;">Lazy_read</span><span style="color: #c0c0c0;">[</span><span style="color: #c0c0c0;">5</span><span style="color: #c0c0c0;">].</span><span style="color: #c0c0c0;">ToString</span>();<br /> <span style="color: #f810b0;">40</span>             <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">41</span>             <span style="color: #c0c0c0;">Lazy_read</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Close</span>();<br /> <span style="color: #696969;">42</span>             <span style="color: #c0c0c0;">Lazy_read</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Dispose</span>();<br /> <span style="color: #696969;">43</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">44</span><br /> <span style="color: #f810b0;">45</span>         <span style="color: #ff4400; font-weight: bold;">private</span> <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #ffff00;">Form1_Load</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">46</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">47</span>             <span style="color: #ffffff;">string</span> <span style="color: #c0c0c0;">Lazy_path</span> <span style="color: #c0c0c0;">=</span> <span style="color: #c0c0c0;">Application</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">StartupPath</span> <span style="color: #c0c0c0;">+</span> <span style="color: #d13800;">&#8220;\\Lazy_Data.accdb&#8221;</span>;<br /> <span style="color: #696969;">48</span>             <span style="color: #696969;">//连接数据库的路径及数据库名</span><br /> <span style="color: #696969;">49</span>             <span style="color: #ffffff;">string</span> <span style="color: #c0c0c0;">constr</span> <span style="color: #c0c0c0;">=</span> <span style="color: #d13800;">&#8220;Provider = Microsoft.ACE.OLEDB.12.0; Data Source =&#8221;</span> <span style="color: #c0c0c0;">+</span> <span style="color: #c0c0c0;">Lazy_path</span>;<br /> <span style="color: #f810b0;">50</span>             <span style="color: #696969;">//生成连接数据库字符串</span><br /> <span style="color: #696969;">51</span>             <span style="color: #c0c0c0;">Lazy_con</span> <span style="color: #c0c0c0;">=</span> <span style="color: #ff4400; font-weight: bold;">new</span> <span style="color: #c0c0c0;">OleDbConnection</span>(<span style="color: #c0c0c0;">constr</span>);<br /> <span style="color: #696969;">52</span>             <span style="color: #696969;">//定义OleDbConnection对象实例并连接数据库</span><br /> <span style="color: #696969;">53</span>             <span style="color: #c0c0c0;">Lazy_con</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Open</span>();<br /> <span style="color: #696969;">54</span>             <span style="color: #ffffff;">string</span> <span style="color: #c0c0c0;">Lazy_sql</span> <span style="color: #c0c0c0;">=</span> <span style="color: #d13800;">&#8220;select * from LazyData&#8221;</span>;<br /> <span style="color: #f810b0;">55</span>             <span style="color: #696969;">//Sql查询语句</span><br /> <span style="color: #696969;">56</span>             <span style="color: #c0c0c0;">OleDbCommand</span> <span style="color: #c0c0c0;">mycom</span> <span style="color: #c0c0c0;">=</span> <span style="color: #ff4400; font-weight: bold;">new</span> <span style="color: #c0c0c0;">OleDbCommand</span>(<span style="color: #c0c0c0;">Lazy_sql</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">Lazy_con</span>);<br /> <span style="color: #696969;">57</span>             <span style="color: #696969;">//定义OleDbCommand对象实例并连接数据库</span><br /> <span style="color: #696969;">58</span>             <span style="color: #c0c0c0;">OleDbDataReader</span> <span style="color: #c0c0c0;">Lazy_read</span> <span style="color: #c0c0c0;">=</span> <span style="color: #c0c0c0;">mycom</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">ExecuteReader</span>();<br /> <span style="color: #696969;">59</span>             <span style="color: #696969;">//定义OleDbDataReader对象实例</span><br /> <span style="color: #f810b0;">60</span>             <span style="color: #c0c0c0;">listView1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">FullRowSelect</span> <span style="color: #c0c0c0;">=</span> <span style="color: #ff4400; font-weight: bold;">true</span>;<br /> <span style="color: #696969;">61</span>             <span style="color: #ff4400; font-weight: bold;">while</span> (<span style="color: #c0c0c0;">Lazy_read</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Read</span>())<br /> <span style="color: #696969;">62</span>             <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">63</span>                 <span style="color: #c0c0c0;">ListViewItem</span> <span style="color: #c0c0c0;">Lazy_item</span> <span style="color: #c0c0c0;">=</span> <span style="color: #ff4400; font-weight: bold;">new</span> <span style="color: #c0c0c0;">ListViewItem</span>(<span style="color: #c0c0c0;">Lazy_read</span><span style="color: #c0c0c0;">[</span><span style="color: #c0c0c0;">1</span><span style="color: #c0c0c0;">].</span><span style="color: #c0c0c0;">ToString</span>());<br /> <span style="color: #696969;">64</span>                 <span style="color: #c0c0c0;">listView1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Items</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Add</span>(<span style="color: #c0c0c0;">Lazy_item</span>);<br /> <span style="color: #f810b0;">65</span>                 <span style="color: #696969;">//把数据库表中“歌曲”字段信息添加到ListView控件中</span><br /> <span style="color: #696969;">66</span>             <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">67</span>             <span style="color: #c0c0c0;">Lazy_read</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Close</span>();<br /> <span style="color: #696969;">68</span>             <span style="color: #c0c0c0;">Lazy_read</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">Dispose</span>();<br /> <span style="color: #696969;">69</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #f810b0;">70</span><br /> <span style="color: #696969;">71</span>         <span style="color: #ff4400; font-weight: bold;">private</span> <span style="color: #ff4400; font-weight: bold;">void</span> <span style="color: #ffff00;">listView1_Click</span>(<span style="color: #ffffff;">object</span> <span style="color: #c0c0c0;">sender</span><span style="color: #c0c0c0;">,</span> <span style="color: #c0c0c0;">EventArgs</span> <span style="color: #c0c0c0;">e</span>)<br /> <span style="color: #696969;">72</span>         <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">73</span>             <span style="color: #c0c0c0;">Lazy_music</span> <span style="color: #c0c0c0;">=</span> <span style="color: #c0c0c0;">listView1</span><span style="color: #c0c0c0;">.</span><span style="color: #c0c0c0;">SelectedItems</span><span style="color: #c0c0c0;">[</span><span style="color: #c0c0c0;"></span><span style="color: #c0c0c0;">].</span><span style="color: #c0c0c0;">SubItems</span><span style="color: #c0c0c0;">[</span><span style="color: #c0c0c0;"></span><span style="color: #c0c0c0;">].</span><span style="color: #c0c0c0;">Text</span>;<br /> <span style="color: #696969;">74</span>             <span style="color: #ff4400; font-weight: bold;">if</span> (<span style="color: #c0c0c0;">Lazy_music</span> <span style="color: #c0c0c0;">!=</span> <span style="color: #ff4400; font-weight: bold;">null</span>)<br /> <span style="color: #f810b0;">75</span>             <span style="color: #c0c0c0;">{</span><br /> <span style="color: #696969;">76</span>                 <span style="color: #c0c0c0;">getScoure</span>(<span style="color: #c0c0c0;">Lazy_music</span>);<br /> <span style="color: #696969;">77</span>             <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">78</span>         <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">79</span><br /> <span style="color: #f810b0;">80</span><br /> <span style="color: #696969;">81</span>     <span style="color: #c0c0c0;">}</span><br /> <span style="color: #696969;">82</span> <span style="color: #c0c0c0;">}</span>
</div>

<span style="color: #ff6600;"><a href="http://down.qiannao.com/space/file/flowerowl/-4e0a-4f20-5206-4eab/Lazy35_-5229-7528ListView-5bfc-822a-6570-636e-5e93-4fe1-606f.rar/.page" target="_blank"><span style="color: #ff6600;">下载源码</span></a></span>

转载请注明：[于哲的博客][1] &raquo; [C#每天抄一点(35):利用ListView导航数据库信息][2]

 [1]: http://localhost/wordpress
 [2]: http://localhost/wordpress/800.html